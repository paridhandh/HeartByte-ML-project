<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Risk Assessment - HeartByte</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

{% include "navbar.html" %}

<div class="form-card fade-in">
    <h1>ü©∫ Cardiovascular Risk Assessment</h1>
    
    <div class="consent-box">
        <input type="checkbox" id="consent" required>
        <label for="consent">
            <strong>I understand and acknowledge:</strong><br>
            ‚Ä¢ This tool provides risk estimates, not medical diagnoses<br>
            ‚Ä¢ Results should be discussed with a qualified healthcare provider<br>
            ‚Ä¢ This does NOT replace professional medical advice or examination<br>
            ‚Ä¢ I should seek immediate care if experiencing cardiac symptoms
        </label>
    </div>

    <form method="POST" onsubmit="return validateForm()">
        
        <h3 style="color: var(--secondary); margin-top: 2rem; margin-bottom: 1rem; border-bottom: 2px solid var(--primary); padding-bottom: 0.5rem;">üìã Demographic Information</h3>
        
        <div class="form-group">
            <label for="age">Age (years) *</label>
            <input type="number" name="age" id="age" placeholder="e.g., 45" required min="18" max="100" step="1">
        </div>

        <div class="form-group">
            <label for="gender">Gender *</label>
            <select name="gender" id="gender" required>
                <option value="">-- Select Gender --</option>
                <option value="1">Male</option>
                <option value="2">Female</option>
            </select>
        </div>

        <h3 style="color: var(--secondary); margin-top: 2rem; margin-bottom: 1rem; border-bottom: 2px solid var(--primary); padding-bottom: 0.5rem;">üìè Physical Measurements</h3>

        <div class="form-group">
            <label for="height">Height (cm) *</label>
            <input type="number" name="height" id="height" placeholder="e.g., 170" required min="100" max="250" step="0.1">
            <small>1 inch = 2.54 cm</small>
        </div>

        <div class="form-group">
            <label for="weight">Weight (kg) *</label>
            <input type="number" name="weight" id="weight" placeholder="e.g., 75" required min="30" max="300" step="0.1">
            <small>1 pound = 0.453592 kg</small>
        </div>

        <h3 style="color: var(--secondary); margin-top: 2rem; margin-bottom: 1rem; border-bottom: 2px solid var(--primary); padding-bottom: 0.5rem;">üíâ Vital Signs & Blood Markers</h3>

        <div class="form-group">
            <label for="ap_hi">Systolic Blood Pressure (mmHg) *</label>
            <input type="number" name="ap_hi" id="ap_hi" placeholder="e.g., 120" required min="70" max="250" step="1">
            <small>Normal range: 90-120 mmHg</small>
        </div>

        <div class="form-group">
            <label for="ap_lo">Diastolic Blood Pressure (mmHg) *</label>
            <input type="number" name="ap_lo" id="ap_lo" placeholder="e.g., 80" required min="40" max="180" step="1">
            <small>Normal range: 60-80 mmHg</small>
        </div>

        <div class="form-group">
            <label for="cholesterol">Cholesterol Level *</label>
            <select name="cholesterol" id="cholesterol" required>
                <option value="">-- Select Level --</option>
                <option value="1">Normal (< 200 mg/dL)</option>
                <option value="2">Above Normal (200-239 mg/dL)</option>
                <option value="3">High (‚â• 240 mg/dL)</option>
            </select>
        </div>

        <div class="form-group">
            <label for="gluc">Glucose Level *</label>
            <select name="gluc" id="gluc" required>
                <option value="">-- Select Level --</option>
                <option value="1">Normal (< 100 mg/dL)</option>
                <option value="2">Above Normal (100-125 mg/dL)</option>
                <option value="3">High (‚â• 126 mg/dL)</option>
            </select>
        </div>

        <h3 style="color: var(--secondary); margin-top: 2rem; margin-bottom: 1rem; border-bottom: 2px solid var(--primary); padding-bottom: 0.5rem;">üèÉ Lifestyle Factors</h3>

        <div class="form-group">
            <label for="smoke">Smoking Status *</label>
            <select name="smoke" id="smoke" required>
                <option value="">-- Select Status --</option>
                <option value="0">Non-smoker</option>
                <option value="1">Current smoker</option>
            </select>
        </div>

        <div class="form-group">
            <label for="alco">Alcohol Consumption *</label>
            <select name="alco" id="alco" required>
                <option value="">-- Select Status --</option>
                <option value="0">No / Minimal</option>
                <option value="1">Regular consumption</option>
            </select>
        </div>

        <div class="form-group">
            <label for="active">Physical Activity *</label>
            <select name="active" id="active" required>
                <option value="">-- Select Activity Level --</option>
                <option value="0">Inactive / Sedentary</option>
                <option value="1">Regularly active</option>
            </select>
        </div>

        <div class="info-note">
            <p>
                <strong>Note:</strong> All fields marked with * are required. Please ensure accuracy of all information for the most reliable risk assessment.
            </p>
        </div>

        <button type="submit" id="submitBtn">
            üî¨ Analyze Cardiovascular Risk
        </button>
    </form>
</div>

<script>
function validateForm() {
    const consent = document.getElementById("consent");
    if (!consent.checked) {
        alert("‚ö†Ô∏è You must acknowledge and accept the medical disclaimer before proceeding.");
        return false;
    }

    // Validate age
    const age = parseFloat(document.getElementById("age").value);
    if (age < 18 || age > 100) {
        alert("‚ö†Ô∏è Please enter a valid age between 18 and 100 years.");
        return false;
    }

    // Validate blood pressure
    const apHi = parseFloat(document.getElementById("ap_hi").value);
    const apLo = parseFloat(document.getElementById("ap_lo").value);
    
    if (apHi <= apLo) {
        alert("‚ö†Ô∏è Systolic blood pressure must be higher than diastolic blood pressure.");
        return false;
    }

    // Disable submit button to prevent double submission
    const submitBtn = document.getElementById("submitBtn");
    submitBtn.disabled = true;
    submitBtn.innerHTML = '‚è≥ Processing...';

    return true;
}

// Add real-time validation feedback
document.getElementById("ap_hi").addEventListener("input", function() {
    const apLo = parseFloat(document.getElementById("ap_lo").value);
    const apHi = parseFloat(this.value);
    
    if (apLo && apHi <= apLo) {
        this.style.borderColor = "var(--danger)";
    } else {
        this.style.borderColor = "var(--border-color)";
    }
});

document.getElementById("ap_lo").addEventListener("input", function() {
    const apHi = parseFloat(document.getElementById("ap_hi").value);
    const apLo = parseFloat(this.value);
    
    if (apHi && apLo >= apHi) {
        this.style.borderColor = "var(--danger)";
    } else {
        this.style.borderColor = "var(--border-color)";
    }
});
</script>

<footer>
    <p>Secure Form | Data Not Stored | Privacy Protected</p>
</footer>

</body>
</html>